áƒ«áƒáƒšáƒ˜áƒáƒœ áƒ™áƒáƒ áƒ’áƒ˜ áƒ¨áƒ”áƒ™áƒ˜áƒ—áƒ®áƒ•áƒ áƒ¢áƒ£áƒ¦áƒ£áƒ¨áƒ˜áƒ âš¡

**ETL = Extract â†’ Transform â†’ Load**  
áƒáƒœáƒ£ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ’áƒáƒ“áƒáƒ¢áƒáƒœáƒ˜áƒ¡áƒ áƒ“áƒ áƒ›áƒáƒ›áƒ–áƒáƒ“áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒ áƒáƒªáƒ”áƒ¡áƒ˜ áƒáƒáƒ”áƒ áƒáƒªáƒ˜áƒ£áƒšáƒ˜ OLTP áƒ‘áƒáƒ–áƒ˜áƒ“áƒáƒœ áƒáƒœ áƒ¡áƒ®áƒ•áƒ áƒ¬áƒ§áƒáƒ áƒáƒ”áƒ‘áƒ˜áƒ“áƒáƒœ áƒáƒœáƒáƒšáƒ˜áƒ¢áƒ˜áƒ™áƒ£áƒ áƒ˜ OLAP áƒ’áƒáƒ áƒ”áƒ›áƒáƒ¡áƒ—áƒ•áƒ˜áƒ¡ (Data Warehouse).

---

### ğŸ“Œ 1. **Extract (áƒáƒ›áƒáƒ¦áƒ”áƒ‘áƒ)**

- áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ¬áƒáƒ›áƒáƒ¦áƒ”áƒ‘áƒ **OLTP áƒáƒœ áƒ¡áƒ®áƒ•áƒ áƒ¬áƒ§áƒáƒ áƒáƒ”áƒ‘áƒ˜áƒ“áƒáƒœ** (SQL Server, API, CSV, IoT device, Kafka).
    
- áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒáƒ, áƒ áƒáƒ› áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ˜ áƒáƒ›áƒáƒ•áƒ˜áƒ¦áƒáƒ— **áƒ¡áƒ¬áƒáƒ áƒáƒ“ áƒ“áƒ áƒ¡áƒ áƒ£áƒšáƒáƒ“**, áƒ›áƒáƒ’áƒ áƒáƒ› áƒáƒ áƒ áƒáƒ£áƒªáƒ˜áƒšáƒ”áƒ‘áƒšáƒáƒ“ áƒáƒáƒ¢áƒ˜áƒ›áƒ˜áƒ–áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ¤áƒáƒ áƒ›áƒ˜áƒ—.
    
- .NET áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜:
    
    ```csharp
    var orders = await _oltp.Orders
        .Where(o => o.CreatedAt >= lastSyncTime)
        .ToListAsync();
    ```
    

---

### ğŸ“Œ 2. **Transform (áƒ’áƒáƒ“áƒáƒ§áƒ•áƒáƒœáƒ/áƒ’áƒáƒ¬áƒ›áƒ”áƒœáƒ“áƒ)**

- áƒáƒ›áƒáƒ¦áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ˜áƒ¡ **áƒ’áƒáƒ“áƒáƒ›áƒ£áƒ¨áƒáƒ•áƒ”áƒ‘áƒ**:
    
    - **áƒ’áƒáƒ¬áƒ›áƒ”áƒœáƒ“áƒ** â€“ áƒ“áƒ£áƒ‘áƒšáƒ˜áƒ™áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒªáƒ˜áƒšáƒ”áƒ‘áƒ, null áƒ•áƒ”áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒáƒ áƒ—áƒ•áƒ.
        
    - **áƒ¡áƒ¢áƒáƒœáƒ“áƒáƒ áƒ¢áƒ˜áƒ–áƒáƒªáƒ˜áƒ** â€“ áƒ—áƒáƒ áƒ˜áƒ¦áƒ”áƒ‘áƒ˜áƒ¡ áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ, áƒ•áƒáƒšáƒ£áƒ¢áƒ˜áƒ¡ áƒ™áƒáƒœáƒ•áƒ”áƒ áƒ¢áƒáƒªáƒ˜áƒ.
        
    - **Aggregation** â€“ áƒ›áƒáƒ’. áƒ¨áƒ”áƒ™áƒ•áƒ”áƒ—áƒ”áƒ‘áƒ˜áƒ¡ áƒ“áƒáƒ¯áƒáƒ›áƒ”áƒ‘áƒ áƒ“áƒ¦áƒ”áƒ–áƒ”/áƒ™áƒ•áƒáƒ áƒ¢áƒáƒšáƒ–áƒ”.
        
    - **Schema Mapping** â€“ áƒ’áƒáƒ“áƒáƒ§áƒ•áƒáƒœáƒ OLTP â†’ OLAP áƒ¡áƒ¢áƒ áƒ£áƒ¥áƒ¢áƒ£áƒ áƒáƒ¨áƒ˜.
        
- .NET áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜:
    
    ```csharp
    var factSales = orders.Select(o => new FactSale
    {
        CustomerId = o.CustomerId,
        Amount = o.Total,
        DateKey = o.CreatedAt.Date,   // áƒ™áƒáƒœáƒ•áƒ”áƒ áƒ¢áƒáƒªáƒ˜áƒ áƒ“áƒ¦áƒ˜áƒ£áƒ  Key-áƒ–áƒ”
        ProductKey = MapProduct(o.ProductId)
    }).ToList();
    ```
    

---

### ğŸ“Œ 3. **Load (áƒ©áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ)**

- áƒ£áƒ™áƒ•áƒ” áƒ¢áƒ áƒáƒœáƒ¡áƒ¤áƒáƒ áƒ›áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ¡ áƒ©áƒáƒ¬áƒ”áƒ áƒ **Data Warehouse-áƒ¨áƒ˜ (OLAP)**.
    
- áƒ©áƒ•áƒ”áƒ£áƒšáƒ”áƒ‘áƒ áƒ˜áƒ• batching / bulk insert-áƒ¡ áƒ˜áƒ§áƒ”áƒœáƒ”áƒ‘áƒ”áƒœ (EF Core Bulk Extensions, SqlBulkCopy).
    
- .NET áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜:
    
    ```csharp
    await _olap.FactSales.AddRangeAsync(factSales);
    await _olap.SaveChangesAsync();
    ```
    

---

### ğŸ”„ áƒ›áƒáƒ™áƒšáƒ”áƒ“ ETL flow:

```
[ OLTP DB / Sources ]
        â”‚
        â–¼
   Extract (SQL/API/Files)
        â”‚
        â–¼
   Transform (Clean, Map, Aggregate)
        â”‚
        â–¼
   Load (Star Schema â†’ OLAP Warehouse)
        â”‚
        â–¼
[ BI Tools / Analytics ]
```

---

### âš™ï¸ Production Considerations

- **Schedule**: ETL áƒ¨áƒ”áƒ˜áƒ«áƒšáƒ”áƒ‘áƒ áƒ˜áƒ§áƒáƒ¡ nightly job (SQL Agent, Hangfire, Quartz.NET) áƒáƒœ near-real-time (Kafka, RabbitMQ).
    
- **Data Quality**: áƒáƒ£áƒªáƒ˜áƒšáƒ”áƒ‘áƒ”áƒšáƒ˜áƒ Validation Rules.
    
- **Incremental Load**: áƒ›áƒ®áƒáƒšáƒáƒ“ áƒáƒ®áƒáƒšáƒ˜ áƒáƒœ áƒ¨áƒ”áƒªáƒ•áƒšáƒ˜áƒšáƒ˜ áƒ©áƒáƒœáƒáƒ¬áƒ”áƒ áƒ”áƒ‘áƒ˜ áƒ’áƒáƒ“áƒ›áƒáƒ’áƒ•áƒáƒ¥áƒ•áƒ¡ (CDC â€“ Change Data Capture).
    
- **Error Handling**: áƒªáƒáƒšáƒ™áƒ” Log/Error Table â†’ áƒ áƒáƒ› áƒ•áƒ˜áƒªáƒáƒ“áƒ”áƒ— áƒ áƒ áƒ©áƒáƒ•áƒáƒ áƒ“áƒ.
    
- **Performance**: áƒ“áƒ˜áƒ“ áƒ›áƒáƒ¡áƒ˜áƒ•áƒ–áƒ” â†’ **bulk insert** áƒáƒœ **partitioned load**.
    

---
